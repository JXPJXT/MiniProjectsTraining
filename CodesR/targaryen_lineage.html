<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêâ House Targaryen Lineage</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Crimson+Text:ital@0;1&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Crimson Text', serif; background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 50%, #0a0a0a 100%); min-height: 100vh; color: #e8d5b7; }
        body::before { content: ''; position: fixed; inset: 0; background: radial-gradient(ellipse at 20% 80%, rgba(139,0,0,0.15) 0%, transparent 50%), radial-gradient(ellipse at 80% 20%, rgba(139,69,19,0.1) 0%, transparent 50%); pointer-events: none; animation: flicker 4s ease-in-out infinite alternate; z-index: -1; }
        @keyframes flicker { 0%,100%{opacity:1} 50%{opacity:0.7} }
        @keyframes glow { from{text-shadow:0 0 10px rgba(218,165,32,0.5)} to{text-shadow:0 0 20px rgba(218,165,32,0.8),0 0 30px rgba(139,0,0,0.5)} }
        @keyframes dragonFloat { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
        @keyframes fadeIn { from{opacity:0;transform:translateY(-10px)} to{opacity:1;transform:translateY(0)} }
        @keyframes highlightPulse { 0%,100%{box-shadow:0 4px 15px rgba(0,0,0,0.5)} 50%{box-shadow:0 0 30px rgba(218,165,32,0.8)} }
        header { text-align: center; padding: 30px 20px; background: linear-gradient(180deg, rgba(139,0,0,0.3) 0%, transparent 100%); border-bottom: 2px solid rgba(218,165,32,0.3); }
        h1 { font-family: 'Cinzel', serif; font-size: 2.5rem; color: #c9a227; animation: glow 3s ease-in-out infinite alternate; letter-spacing: 4px; }
        .subtitle { font-style: italic; color: #8b8b8b; margin-top: 10px; }
        .dragon-icon { font-size: 1.8rem; margin: 0 10px; animation: dragonFloat 2s ease-in-out infinite; }
        .stats-bar { display: flex; justify-content: center; gap: 40px; padding: 15px; background: rgba(0,0,0,0.5); border-bottom: 1px solid rgba(218,165,32,0.2); flex-wrap: wrap; }
        .stat { text-align: center; }
        .stat-value { font-family: 'Cinzel', serif; font-size: 1.8rem; color: #c9a227; }
        .stat-label { font-size: 0.85rem; color: #8b8b8b; text-transform: uppercase; letter-spacing: 2px; }
        .main-container { display: flex; flex-wrap: wrap; }
        .tree-section { flex: 1; min-width: 60%; padding: 30px; overflow-x: auto; }
        .console-section { width: 350px; background: rgba(10,5,5,0.95); border-left: 2px solid rgba(218,165,32,0.3); display: flex; flex-direction: column; max-height: calc(100vh - 150px); position: sticky; top: 0; }
        .console-header { padding: 15px; background: linear-gradient(180deg, rgba(139,0,0,0.4) 0%, transparent 100%); border-bottom: 1px solid rgba(218,165,32,0.3); }
        .console-header h3 { font-family: 'Cinzel', serif; color: #c9a227; font-size: 1rem; }
        .console-output { flex: 1; overflow-y: auto; padding: 15px; font-family: 'Courier New', monospace; font-size: 0.9rem; background: rgba(0,0,0,0.3); }
        .console-output .line { margin: 3px 0; padding: 2px 0; }
        .console-output .cmd { color: #c9a227; }
        .console-output .result { color: #8fbc8f; }
        .console-output .error { color: #cd5c5c; }
        .console-output .info { color: #87ceeb; }
        .console-input-area { padding: 10px; border-top: 1px solid rgba(218,165,32,0.2); display: flex; gap: 10px; }
        .console-input-area input { flex: 1; font-family: 'Courier New', monospace; font-size: 0.9rem; padding: 10px; border: 1px solid rgba(218,165,32,0.3); border-radius: 6px; background: rgba(20,5,5,0.8); color: #e8d5b7; }
        .console-input-area input:focus { outline: none; border-color: #c9a227; }
        .console-input-area button { padding: 10px 15px; border: 1px solid #c9a227; border-radius: 6px; background: rgba(139,0,0,0.3); color: #c9a227; cursor: pointer; font-family: 'Cinzel', serif; font-size: 0.8rem; }
        .console-input-area button:hover { background: rgba(218,165,32,0.2); }
        .cmd-buttons { display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; border-bottom: 1px solid rgba(218,165,32,0.2); }
        .cmd-btn { padding: 6px 10px; border: 1px solid rgba(218,165,32,0.4); border-radius: 4px; background: rgba(30,10,10,0.8); color: #c9a227; cursor: pointer; font-size: 0.75rem; font-family: 'Courier New', monospace; }
        .cmd-btn:hover { background: rgba(139,0,0,0.4); border-color: #c9a227; }
        #tree-container { display: flex; flex-direction: column; align-items: center; }
        .tree-node { display: flex; flex-direction: column; align-items: center; position: relative; }
        .node-card { background: linear-gradient(145deg, rgba(30,10,10,0.9) 0%, rgba(20,5,5,0.95) 100%); border: 2px solid rgba(218,165,32,0.4); border-radius: 10px; padding: 12px 20px; text-align: center; min-width: 120px; cursor: pointer; transition: all 0.3s ease; }
        .node-card:hover { transform: translateY(-5px) scale(1.05); border-color: #c9a227; box-shadow: 0 10px 30px rgba(139,0,0,0.3); }
        .node-card.founder { border-color: #c9a227; background: linear-gradient(145deg, rgba(50,20,0,0.9) 0%, rgba(30,10,0,0.95) 100%); }
        .node-card.selected { border-color: #ff6b6b; box-shadow: 0 0 20px rgba(255,107,107,0.5); }
        .node-name { font-family: 'Cinzel', serif; font-size: 1rem; color: #e8d5b7; font-weight: 700; }
        .node-title { font-size: 0.8rem; color: #8b8b8b; font-style: italic; margin-top: 3px; }
        .children-container { display: flex; gap: 25px; margin-top: 45px; position: relative; justify-content: center; }
        .children-container::before { content: ''; position: absolute; top: -22px; left: 50%; width: 2px; height: 22px; background: linear-gradient(180deg, rgba(218,165,32,0.6) 0%, rgba(139,0,0,0.4) 100%); }
        .highlight { animation: highlightPulse 1s ease; }
        footer { text-align: center; padding: 20px; color: #555; font-size: 0.85rem; border-top: 1px solid rgba(218,165,32,0.1); }
        @media (max-width: 900px) { .console-section { width: 100%; max-height: 400px; } .tree-section { min-width: 100%; } }
    </style>
</head>
<body>
    <header>
        <h1><span class="dragon-icon">üêâ</span>HOUSE TARGARYEN<span class="dragon-icon">üêâ</span></h1>
        <p class="subtitle">"Fire and Blood" - The Royal Lineage</p>
    </header>
    <div class="stats-bar">
        <div class="stat"><div class="stat-value" id="total-members">0</div><div class="stat-label">Members</div></div>
        <div class="stat"><div class="stat-value" id="generations">0</div><div class="stat-label">Generations</div></div>
        <div class="stat"><div class="stat-value" id="founder">-</div><div class="stat-label">Founder</div></div>
    </div>
    <div class="main-container">
        <div class="tree-section"><div id="tree-container"></div></div>
        <div class="console-section">
            <div class="console-header"><h3>üî• COMMAND CONSOLE</h3></div>
            <div class="cmd-buttons">
                <button class="cmd-btn" onclick="runCmd('help')">help</button>
                <button class="cmd-btn" onclick="runCmd('print')">print</button>
                <button class="cmd-btn" onclick="runCmd('stats')">stats</button>
                <button class="cmd-btn" onclick="runCmd('clear')">clear</button>
            </div>
            <div class="console-output" id="console-output"></div>
            <div class="console-input-area">
                <input type="text" id="cmdInput" placeholder="Enter command..." onkeydown="if(event.key==='Enter')runCmd()">
                <button onclick="runCmd()">Run</button>
            </div>
        </div>
    </div>
    <footer><p>üêâ Interactive Targaryen Lineage Visualizer üêâ</p></footer>

<script>
const treeData = {"name":"Aegon I","title":"The Conqueror","children":[{"name":"Aenys I","title":"The Weak","children":[{"name":"Jaehaerys I","title":"The Conciliator","children":[{"name":"Baelon","title":"Prince","children":[{"name":"Viserys I","title":"The Peaceful","children":[{"name":"Rhaenyra","title":"The Realm's Delight","children":[{"name":"Jacaerys","title":"Prince","children":[{"name":"Aegon III","title":"The Dragonbane","children":[{"name":"Viserys II","children":[{"name":"Aegon IV","title":"The Unworthy","children":[{"name":"Daemon Blackfyre","title":"The Black Dragon","children":[]}]}]}]}]},{"name":"Lucerys","title":"Prince","children":[]}]},{"name":"Aegon II","title":"The Usurper","children":[]}]},{"name":"Daemon","title":"Prince of the City","children":[{"name":"Aemond","title":"One-Eye","children":[]},{"name":"Helaena","title":"Princess","children":[]}]}]}]}]},{"name":"Maegor I","title":"The Cruel","children":[]}]};
const nodeLookup = {};
let selectedNode = null;

function buildLookup(node, parent = null) {
    nodeLookup[node.name] = { ...node, parentName: parent ? parent.name : null };
    if (node.children) node.children.forEach(c => buildLookup(c, node));
}
buildLookup(treeData);

function countNodes(n) { return 1 + (n.children ? n.children.reduce((a,c) => a + countNodes(c), 0) : 0); }
function getHeight(n) { return (!n.children || !n.children.length) ? 0 : 1 + Math.max(...n.children.map(getHeight)); }
function getAncestors(name) { const a = []; let c = nodeLookup[name]; while(c && c.parentName) { a.push(c.parentName); c = nodeLookup[c.parentName]; } return a; }
function getDescendants(name) { const d = [], n = nodeLookup[name]; function dfs(x) { if(x.children) x.children.forEach(c => { d.push(c.name); dfs(nodeLookup[c.name]); }); } if(n) dfs(n); return d; }
function getChildren(name) { const n = nodeLookup[name]; return n && n.children ? n.children.map(c => c.name) : []; }
function getParent(name) { const n = nodeLookup[name]; return n ? (n.parentName || 'None') : 'Not found'; }
function pathToRoot(name) { const p = []; let n = nodeLookup[name]; while(n) { p.unshift(n.name); n = n.parentName ? nodeLookup[n.parentName] : null; } return p; }
function isDescendant(child, anc) { return getAncestors(child).includes(anc); }

document.getElementById('total-members').textContent = countNodes(treeData);
document.getElementById('generations').textContent = getHeight(treeData) + 1;
document.getElementById('founder').textContent = treeData.name;

function buildTreeHTML(node, isRoot = false) {
    const div = document.createElement('div'); div.className = 'tree-node';
    const card = document.createElement('div'); card.className = 'node-card' + (isRoot ? ' founder' : ''); card.dataset.name = node.name;
    card.innerHTML = `<div class="node-name">${isRoot?'üëë ':''}${node.name}</div>${node.title?`<div class="node-title">${node.title}</div>`:''}`;
    card.onclick = () => selectNode(node.name);
    div.appendChild(card);
    if (node.children && node.children.length) {
        const cc = document.createElement('div'); cc.className = 'children-container';
        node.children.forEach(c => cc.appendChild(buildTreeHTML(c)));
        div.appendChild(cc);
    }
    return div;
}
document.getElementById('tree-container').appendChild(buildTreeHTML(treeData, true));

function selectNode(name) {
    document.querySelectorAll('.node-card').forEach(c => c.classList.remove('selected'));
    const card = document.querySelector(`.node-card[data-name="${name}"]`);
    if (card) { card.classList.add('selected'); card.scrollIntoView({behavior:'smooth',block:'center'}); }
    selectedNode = name;
    log(`Selected: ${name}`, 'info');
}

function log(msg, type = 'result') {
    const out = document.getElementById('console-output');
    const line = document.createElement('div'); line.className = `line ${type}`; line.textContent = msg;
    out.appendChild(line); out.scrollTop = out.scrollHeight;
}

function runCmd(cmd) {
    const input = document.getElementById('cmdInput');
    const command = cmd || input.value.trim();
    if (!command) return;
    input.value = '';
    log(`> ${command}`, 'cmd');
    const parts = command.split(' ');
    const action = parts[0].toLowerCase();
    const arg = parts.slice(1).join(' ');
    try {
        switch(action) {
            case 'help': log('Commands: parent <name>, children <name>, ancestors <name>, descendants <name>, path <name>, check <child> <ancestor>, print, stats, select <name>, clear', 'info'); break;
            case 'parent': log(arg ? `Parent of ${arg}: ${getParent(arg)}` : 'Usage: parent <name>'); break;
            case 'children': if(arg) { const c = getChildren(arg); log(`Children of ${arg}: ${c.length?c.join(', '):'None'}`); } else log('Usage: children <name>'); break;
            case 'ancestors': if(arg) { const a = getAncestors(arg); log(`Ancestors of ${arg}: ${a.length?a.join(' ‚Üí '):'None (Founder)'}`); } else log('Usage: ancestors <name>'); break;
            case 'descendants': if(arg) { const d = getDescendants(arg); log(`Descendants of ${arg}: ${d.length?d.join(', '):'None'}`); } else log('Usage: descendants <name>'); break;
            case 'path': if(arg) { const p = pathToRoot(arg); log(`Path: ${p.join(' ‚Üí ')}`); } else log('Usage: path <name>'); break;
            case 'check': const [c, ...anc] = parts.slice(1); if(c && anc.length) { log(isDescendant(c, anc.join(' ')) ? `‚úì ${c} IS a descendant of ${anc.join(' ')}` : `‚úó ${c} is NOT a descendant of ${anc.join(' ')}`); } else log('Usage: check <child> <ancestor>'); break;
            case 'select': if(arg && nodeLookup[arg]) selectNode(arg); else log(arg ? 'Member not found' : 'Usage: select <name>', 'error'); break;
            case 'stats': log(`Total Members: ${countNodes(treeData)}`); log(`Generations: ${getHeight(treeData)+1}`); log(`Founder: ${treeData.name}`); break;
            case 'print': printTree(treeData, '', true); break;
            case 'clear': document.getElementById('console-output').innerHTML = ''; break;
            default: log('Unknown command. Type "help"', 'error');
        }
    } catch(e) { log(`Error: ${e.message}`, 'error'); }
}

function printTree(node, prefix = '', isRoot = true) {
    log(`${prefix}${isRoot?'üëë ':'‚îú‚îÄ‚îÄ '}${node.name}${node.title?' ('+node.title+')':''}`);
    if (node.children) node.children.forEach((c, i) => printTree(c, prefix + (isRoot?'':'‚îÇ   '), false));
}

log('Welcome to Targaryen Lineage Console!', 'info');
log('Type "help" for commands or click on a member.', 'info');
</script>
</body>
</html>